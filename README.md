The code here is an edited version of Pedro Arbalaez's work. His work is great and so I decided to use it for one 
of my projects.
